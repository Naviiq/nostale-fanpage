<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Nostale Fanpage ‚Äì Heldenb√ºcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* Grundlayout */
    body{margin:0;font-family:'Segoe UI','Trebuchet MS',system-ui,-apple-system,sans-serif;color:#fff;background:url("https://i.postimg.cc/PJzGHfHB/background.png") center/cover fixed no-repeat;min-height:100vh;display:flex;flex-direction:column}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:10px 24px;background:rgba(0,0,0,.4);backdrop-filter:blur(6px);box-shadow:0 2px 10px rgba(0,0,0,.5);flex-wrap:wrap}
    header .logo img{max-height:60px;filter:drop-shadow(0 0 8px rgba(255,255,255,.7))}
    nav{flex:1;display:flex;justify-content:center;gap:22px;flex-wrap:wrap}
    nav a{text-decoration:none;color:#fff;padding:8px 14px;border-radius:12px;font-weight:600;transition:.25s ease}
    nav a:hover{background:rgba(255,255,255,.15)}

    /* Seite */
    .page{width:min(900px,92vw);margin:40px auto;display:flex;flex-direction:column;gap:16px}
    h1{margin:0;text-shadow:0 0 12px rgba(255,215,0,.45)}

    .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .controls input[type="text"]{flex:1;min-width:240px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.28);color:#fff;border-radius:10px;padding:10px 12px}
    .btn{padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.12);color:#fff;cursor:pointer;font-weight:600}
    .btn:hover{background:rgba(255,255,255,.2)}
    .btn.secondary{background:rgba(0,0,0,.35)}
    .muted{opacity:.85}

    /* Fortschritt */
    .progress{height:12px;background:rgba(255,255,255,.15);border-radius:10px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,#8ef,#6f8);width:0%}

    /* Vertikale Buchliste */
    .list{display:flex;flex-direction:column;gap:12px}
    .book{
      display:flex;gap:12px;align-items:flex-start;
      background:rgba(0,0,0,.55);backdrop-filter:blur(8px);
      border:1px solid rgba(255,255,255,.18);border-radius:14px;padding:12px;
      position:relative;
    }
    .book img.icon{width:44px;height:44px;border-radius:10px;box-shadow:0 0 8px rgba(255,255,255,.2)}
    .book h3{margin:0 0 6px 0;font-size:1.05rem}
    .desc{opacity:.85;font-size:.92rem}
    .right{margin-left:auto;display:flex;align-items:center;gap:8px}

    /* Checkbox: beim Abhaken nur f√ºllen (kein Haken) */
    .check{
      appearance:none;width:22px;height:22px;border-radius:6px;
      border:2px solid rgba(255,255,255,.55);
      background:rgba(255,255,255,.08);
      cursor:pointer;display:inline-block;transition:.15s ease-in-out;
    }
    .check:checked{border-color:#8fd;background:linear-gradient(135deg,#3aa0ff,#00d2a8)}

    /* Heldenlevel-Badge (unten rechts) */
    .hero-badge{
      position:absolute;right:12px;bottom:8px;
      font-size:.82rem;display:flex;align-items:center;gap:6px;
      padding:1px 8px;border-radius:500px;
      background:rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.25);opacity:.95
    }
    .hero-badge .val{font-weight:700;color:#dff}
    .hero-badge .edit{
      border:none;background:rgba(0,0,0,.35);
      color:#fff;font-weight:700;cursor:pointer;
      border-radius:6px;padding:2px 6px;line-height:1
    }
    .hero-badge .edit:hover{background:rgba(0,0,0,.5)}
    /* Edit-Buttons ausblenden, solange gesperrt */
    body:not(.edit-unlocked) .hero-badge .edit{ display:none }

    /* Footer (einheitlich) */
    .footer{text-align:center;padding:26px 16px;background:rgba(0,0,0,.35);backdrop-filter:blur(8px);border-top:1px solid rgba(255,255,255,.18);margin-top:auto}
    .footer p{margin:0 0 10px;color:#fff;font-weight:500}
    .footer .socials{display:flex;justify-content:center;align-items:center;gap:22px;margin:6px 0 0}
    .footer .socials img{width:28px;height:28px;filter:drop-shadow(0 0 6px rgba(255,255,255,.5));transition:transform .15s ease}
    .footer .socials img:hover{transform:translateY(-1px) scale(1.05)}
  </style>
</head>
<body>
  <header>
    <a href="index.html" class="logo"><img src="https://i.postimg.cc/ZRjbPLB9/noslogo.png" alt="Logo"></a>
    <nav>
      <a href="heldenbuecher.html">Heldenb√ºcher</a>
      <a href="cella-rechner.html">Cella-Rechner</a>
      <a href="fishing-rechner.html">Lure-Rechner</a>
      <a href="lod_times.html">LoD & LoL Zeiten</a>
      <a href="traenke-herstellung.html">Tr√§nke-Herstellung</a>
      <a href="damage-info.html">Damage-Info</a>
      <a href="raid-info.html">Raid-Info</a>
      <a href="perfektion.html">Perfektion</a>
    </nav>
  </header>

  <section class="page">
    <h1>Heldenb√ºcher</h1>

    <div class="controls">
      <input id="search" type="text" placeholder="Suchen‚Ä¶ (z. B. PvP, Verteidigung, Memorial ‚Ä¶)">
      <button id="selectAll" class="btn">Alle w√§hlen</button>
      <button id="clearAll" class="btn secondary">Alle leeren</button>
      <button id="toggleEdit" class="btn secondary" title="Heldenlevel-Bearbeitung sperren/entsperren">üîí Bearbeiten</button>
      <span class="muted" id="countInfo"></span>
    </div>

    <div class="progress"><div class="bar" id="bar"></div></div>
    <div class="muted" id="progressText">0 / 52 abgeschlossen</div>

    <div class="list" id="list"></div>
  </section>

  <footer class="footer">
    <p>¬© 2025 Nostale Fanpage ‚Äì Erstellt mit <span style="color:#ff4d79">‚ù§</span></p>
    <div class="socials">
      <a href="https://discord.com" target="_blank"><img src="https://i.postimg.cc/660jKtQK/discord.png" alt="Discord" /></a>
      <a href="https://instagram.com" target="_blank"><img src="https://i.postimg.cc/ncRM6R92/insta.png" alt="Instagram" /></a>
      <a href="https://x.com" target="_blank"><img src="https://i.postimg.cc/3xxJ1gLG/Twitter.png" alt="X" /></a>
    </div>
  </footer>

  <script>
    const ICONS={pvp:"https://i.postimg.cc/9QrPcspM/buchrot.png",def:"https://i.postimg.cc/GpTjx68N/buchgr-n.png",other:"https://i.postimg.cc/B68RDh4Q/buchgelb.png"};

    /* ‚îÄ‚îÄ Passwort-Steuerung (nur Client-seitig, Basis-Schutz) ‚îÄ‚îÄ */
    const ADMIN_PASSWORD = "nostale123";               // <‚Äî hier dein Passwort setzen
    const EDIT_FLAG_KEY  = "hb_edit_unlocked_session"; // sessionStorage-Flag

    function isUnlocked(){ return sessionStorage.getItem(EDIT_FLAG_KEY)==="1"; }
    function setUnlocked(v){
      if(v) sessionStorage.setItem(EDIT_FLAG_KEY,"1");
      else sessionStorage.removeItem(EDIT_FLAG_KEY);
      document.body.classList.toggle("edit-unlocked", v);
      const btn = document.getElementById("toggleEdit");
      if(btn) btn.textContent = v ? "üîì Bearbeiten aktiv" : "üîí Bearbeiten";
    }

    /* Persistenz-Keys */
    const STORAGE_CHECK = "booksState";
    const STORAGE_HERO  = "heroLevels_v1"; // Titel -> Level

    /* Optionale Default-Level */
    const DEFAULT_HERO_LEVELS = { };

    /* B√ºcher (ALLE 52) */
    const BOOKS = [
      // PvP (rot)
      { title: "[Einfach] PvP-Schadenserh√∂hung", type: "pvp", desc: "Erh√∂ht den PvP-Schaden um 1%." },
      { title: "[Mittel] PvP-Schadenserh√∂hung", type: "pvp", desc: "Erh√∂ht den PvP-Schaden um 2%." },
      { title: "[Fortgeschritten] PvP-Schadenserh√∂hung", type: "pvp", desc: "Erh√∂ht den PvP-Schaden um 3%." },
      { title: "[Hervorragend] PvP-Schadenserh√∂hung", type: "pvp", desc: "Erh√∂ht den PvP-Schaden um 5%." },

      // Verteidigung (gr√ºn)
      { title: "[Einfach] PvP-Verteidigungserh√∂hung", type: "def", desc: "Erh√∂ht die Verteidigung im PvP um 1%." },
      { title: "[Mittel] PvP-Verteidigungserh√∂hung", type: "def", desc: "Erh√∂ht die Verteidigung im PvP um 2%." },
      { title: "[Fortgeschritten] PvP-Verteidigungserh√∂hung", type: "def", desc: "Erh√∂ht die Verteidigung im PvP um 3%." },
      { title: "[Hervorragend] PvP-Verteidigungserh√∂hung", type: "def", desc: "Erh√∂ht die Verteidigung im PvP um 5%." },

      // Memorials & Strategien
      { title: "Memorial des vergessenen Helden D (1)", type: "other", desc: "Erh√∂ht den Nahkampfangriff um 80. Erh√∂ht die Nahangriffsverteidigung um 40." },
      { title: "Memorial des vergessenen Helden S (1)", type: "other", desc: "Erh√∂ht die Fernangriffskraft um 80. Erh√∂ht die Fernangriffsverteidigung um 40. Erh√∂ht die Hitrate um 160. Erh√∂ht das Ausweichen um 80." },
      { title: "Memorial des vergessenen Helden J (1)", type: "other", desc: "Erh√∂ht die Magieangriffskraft um 80. Erh√∂ht die Magieverteidigung um 40." },
      { title: "Memorial des vergessenen Helden M (1)", type: "other", desc: "Erh√∂ht die maximalen HP um 4000." },
      { title: "Memorial des unbekannten Helden (1)", type: "other", desc: "Erh√∂ht die maximalen MP um 4000." },
      { title: "Memorial des unbekannten Helden (2)", type: "other", desc: "Erh√∂ht die maximalen MP um 6000." },
      { title: "Memorial des vergessenen Helden D (2)", type: "other", desc: "Erh√∂ht den Nahkampfangriff um 100. Erh√∂ht die Nahangriffsverteidigung um 50." },
      { title: "Memorial des vergessenen Helden S (2)", type: "other", desc: "Erh√∂ht die Fernangriffskraft um 100. Erh√∂ht die Fernangriffsverteidigung um 50. Erh√∂ht die Hitrate um 200. Erh√∂ht das Ausweichen um 100." },
      { title: "Memorial des vergessenen Helden J (2)", type: "other", desc: "Erh√∂ht die Magieangriffskraft um 100. Erh√∂ht die Magieverteidigung um 50." },
      { title: "Memorial des vergessenen Helden M (2)", type: "other", desc: "Erh√∂ht die maximalen HP um 6000." },

      { title: "Angriffsstrategie von Lord Cuarrys Rittern (1)", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 30." },
      { title: "Abwehrstrategie von Lord Cuarrys Rittern (1)", type: "other", desc: "Erh√∂ht alle Verteidigungen um 30." },
      { title: "Abwehrstrategie von Lord Cuarrys Rittern (2)", type: "other", desc: "Erh√∂ht alle Verteidigungen um 50." },
      { title: "Angriffsstrategie von Lord Cuarrys Rittern (2)", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 50." },

      // Loa-B√ºcher
      { title: "Buch des B√§ren-Loa", type: "other", desc: "Erh√∂ht die maximalen HP um 7000." },
      { title: "Buch des Adler-Loa", type: "other", desc: "Erh√∂ht die Fernangriffskraft um 120. Erh√∂ht die Fernangriffsverteidigung um 60. Erh√∂ht die Hitrate um 240. Erh√∂ht das Ausweichen um 120." },
      { title: "Buch des Schlangen-Loa", type: "other", desc: "Erh√∂ht die Magieangriffskraft um 120. Erh√∂ht die Magieverteidigung um 60." },
      { title: "Buch des L√∂wen-Loa", type: "other", desc: "Erh√∂ht den Nahkampfangriff um 120. Erh√∂ht die Nahangriffsverteidigung um 60." },
      { title: "Buch des Geisterk√∂nigs", type: "other", desc: "Erh√∂ht die maximalen MP um 7000." },

      // Sonstige B√ºcher
      { title: "Aurelius Roshus Urgeschichte (1)", type: "other", desc: "Erh√∂ht den Erfahrungsgewinn um 5%." },
      { title: "Memorial der Akamuh√§ndler (1)", type: "other", desc: "Erh√∂ht den Goldgewinn um 3%." },

      // Professionen & Training
      { title: "Profi-Fischer-Handbuch", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 50. Erh√∂ht alle Verteidigungen um 50." },
      { title: "Grundlagen-Krafttraining f√ºr K√∂che", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 30. Erh√∂ht alle Verteidigungen um 30." },
      { title: "Fortgeschrittenen-Krafttraining f√ºr K√∂che", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 50. Erh√∂ht alle Verteidigungen um 50." },
      { title: "Experten-Krafttraining f√ºr K√∂che", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 100. Erh√∂ht alle Verteidigungen um 100." },
      { title: "Haustiertrainer-Anleitung 1", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 25. Erh√∂ht alle Verteidigungen um 25." },
      { title: "Haustiertrainer-Anleitung 2", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 50. Erh√∂ht alle Verteidigungen um 50." },
      { title: "Haustiertrainer-Anleitung 3", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 100. Erh√∂ht alle Verteidigungen um 100." },

      // Drachen-Lehrb√ºcher
      { title: "Lehrbuch ¬ªDrachenagilit√§t¬´", type: "other", desc: "Erh√∂ht die Fernangriffskraft um 150. Erh√∂ht die Fernangriffsverteidigung um 75. Erh√∂ht die Hitrate um 300. Erh√∂ht das Ausweichen um 150." },
      { title: "Lehrbuch ¬ªDrachenintellekt¬´", type: "other", desc: "Erh√∂ht die Magieangriffskraft um 150. Erh√∂ht die Magieverteidigung um 75" },
      { title: "Lehrbuch ¬ªDrachenkraft¬´", type: "other", desc: "Erh√∂ht den Nahkampfangriff um 150. Erh√∂ht die Nahangriffsverteidigung um 75." },
      { title: "Lehrbuch ¬ªDrachenmagie¬´", type: "other", desc: "Erh√∂ht die maximalen MP um 10000." },
      { title: "Lehrbuch ¬ªDrachenvitalit√§t¬´", type: "other", desc: "Erh√∂ht die maximalen HP um 10000." },

      // Techrons Forschung
      { title: "Techrons Muskelforschung", type: "other", desc: "Erh√∂ht die maximalen HP um 13000." },
      { title: "Techrons Kognitionsforschung", type: "other", desc: "Erh√∂ht die Fernangriffskraft um 200. Erh√∂ht die Fernangriffsverteidigung um 100. Erh√∂ht die Hitrate um 400. Erh√∂ht das Ausweichen um 200." },
      { title: "Techrons Hirnforschung", type: "other", desc: "Erh√∂ht die Magieangriffskraft um 220. Erh√∂ht die Magieverteidigung um 110." },
      { title: "Techrons Knochenforschung", type: "other", desc: "Erh√∂ht den Nahkampfangriff um 200. Erh√∂ht die Nahangriffsverteidigung um 100." },
      { title: "Techrons Magieforschung", type: "other", desc: "Erh√∂ht die maximalen MP um 13000." },

      // Freundschaften / Handb√ºcher
      { title: "Feenfreundschaft (1)", type: "other", desc: "Erh√∂ht alle Elementresistenzen um 10." },
      { title: "Feenfreundschaft (2)", type: "other", desc: "Erh√∂ht alle Elementresistenzen um 20." },

      { title: "Handbuch des Lebens", type: "other", desc: "Erh√∂ht die maximalen HP um 3000. Erh√∂ht die maximalen MP um 3000." },
      { title: "Handbuch des Kriegers", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 100. Erh√∂ht alle Verteidigungen um 100." },
      { title: "Handbuch des Sammlers", type: "other", desc: "Mit einer Wahrscheinlichkeit von 5% erh√§ltst du eine zus√§tzliche Raidbox. Mit einer Wahrscheinlichkeit von 5% erh√§ltst du einen zus√§tzlichen Raidtoken (au√üer Hardcore-Raidmarken)." },
      { title: "Fruchtforschung f√ºr Fortgeschrittene", type: "other", desc: "Erh√∂ht alle Angriffskr√§fte um 30. Erh√∂ht alle Verteidigungen um 30." },
    ];

    /* State & Persistenz laden */
    let stateChecks = JSON.parse(localStorage.getItem(STORAGE_CHECK) || "{}"); // {index:1/0}
    let heroLevels  = (()=> {
      const raw = localStorage.getItem(STORAGE_HERO);
      if (raw) return JSON.parse(raw);
      localStorage.setItem(STORAGE_HERO, JSON.stringify(DEFAULT_HERO_LEVELS));
      return {...DEFAULT_HERO_LEVELS};
    })();

    const listEl=document.getElementById("list");
    const searchEl=document.getElementById("search");
    const barEl=document.getElementById("bar");
    const progressText=document.getElementById("progressText");
    const countInfo=document.getElementById("countInfo");
    const btnAll=document.getElementById("selectAll");
    const btnClear=document.getElementById("clearAll");
    const btnToggleEdit=document.getElementById("toggleEdit");

    function iconFor(type){ return ICONS[type] || ICONS.other; }

    function render(){
      const q=searchEl.value.trim().toLowerCase();
      listEl.innerHTML="";
      let visible=0;

      BOOKS.forEach((b,i)=>{
        const match=!q||b.title.toLowerCase().includes(q)||b.desc.toLowerCase().includes(q)||(b.type||"").toLowerCase().includes(q);
        if(!match) return;
        visible++;

        const level = (heroLevels[b.title] ?? "‚Äî");

        const card=document.createElement("div");
        card.className="book";
        card.innerHTML=`
          <img class="icon" src="${iconFor(b.type)}" alt="">
          <div style="flex:1">
            <h3>${b.title}</h3>
            <div class="desc">${b.desc}</div>
          </div>
          <div class="right">
            <input type="checkbox" class="check" data-idx="${i}" ${stateChecks[i]?'checked':''}/>
          </div>
          <div class="hero-badge" data-title="${b.title}">
            <span>Heldenlevel:</span>
            <span class="val">${level}</span>
            <button class="edit" title="Heldenlevel bearbeiten" aria-label="Heldenlevel bearbeiten">‚úé</button>
          </div>
        `;
        listEl.appendChild(card);
      });

      countInfo.textContent = visible===BOOKS.length ? `${BOOKS.length} B√ºcher` : `${visible}/${BOOKS.length} angezeigt`;
      wireEvents();
      updateProgress();
    }

    function wireEvents(){
      // Checkboxen
      listEl.querySelectorAll(".check").forEach(cb=>{
        cb.addEventListener("change",()=>{
          const idx=cb.getAttribute("data-idx");
          stateChecks[idx]=cb.checked?1:0;
          localStorage.setItem(STORAGE_CHECK,JSON.stringify(stateChecks));
          updateProgress();
        });
      });

      // Edit-Buttons f√ºr Heldenlevel
      listEl.querySelectorAll(".hero-badge .edit").forEach(btn=>{
        btn.addEventListener("click",(e)=>{
          if(!isUnlocked()){ alert("Bearbeiten ist gesperrt. Bitte oben mit Passwort entsperren."); return; }
          const badge = e.target.closest(".hero-badge");
          const title = badge.getAttribute("data-title");
          const current = heroLevels[title] ?? "";
          const input = prompt(`Heldenlevel f√ºr:\n${title}\n\nGib z. B. ‚ÄûH25‚Äú, ‚ÄûH30+‚Äú oder Zahl ein.\nLeer lassen f√ºr ‚Äû‚Äî‚Äú.`, current);
          if (input === null) return; // abgebrochen
          const val = (input || "").trim();
          if (val === "") { delete heroLevels[title]; }
          else { heroLevels[title] = val; }
          localStorage.setItem(STORAGE_HERO, JSON.stringify(heroLevels));
          badge.querySelector(".val").textContent = heroLevels[title] ?? "‚Äî";
        });
      });
    }

    function updateProgress(){
      const done=Object.values(stateChecks).filter(Boolean).length;
      const total=BOOKS.length;
      const pct= total ? Math.round(done/total*100) : 0;
      barEl.style.width = pct + "%";
      progressText.textContent = `${done} / ${total} abgeschlossen (${pct}%)`;
    }

    // Alle w√§hlen / leeren
    btnAll.addEventListener("click",()=>{
      BOOKS.forEach((_,i)=>{ stateChecks[i]=1; });
      localStorage.setItem(STORAGE_CHECK, JSON.stringify(stateChecks));
      render();
    });
    btnClear.addEventListener("click",()=>{
      stateChecks={};
      localStorage.setItem(STORAGE_CHECK, JSON.stringify(stateChecks));
      render();
    });

    // Lock/Unlock steuern
    btnToggleEdit.addEventListener("click",()=>{
      if(isUnlocked()){
        setUnlocked(false);
      }else{
        const pw = prompt("Passwort zum Bearbeiten eingeben:");
        if(pw===null) return;
        if(pw===ADMIN_PASSWORD){
          setUnlocked(true);
        }else{
          alert("Falsches Passwort.");
        }
      }
    });

    // Initialen Lock-Status setzen & Render
    setUnlocked(isUnlocked());
    searchEl.addEventListener("input",render);
    render();
  </script>
</body>
</html>
